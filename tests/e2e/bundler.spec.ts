import { test, expect } from '@playwright/test' test.d e scribe('Bundler Application', () => { t e st('login gate renders', async ({ page }) => { await page.g o to('/')//Should show login gate await e x pect(page.g e tByText('Login Required')).t oB eVisible() await e x pect( page.g e tByText('Connect a crypto wal let to continue')).t oB eVisible() await e x pect( page.g e tByRole('button', { n, a, m, e: 'Connect Wallet' })).t oB eVisible() }) t e st('login modal opens', async ({ page }) => { await page.g o to('/')//Click connect wal let button await page.g e tByRole('button', { n, a, m, e: 'Connect Wallet' }).c l ick()//Should open wal let m o dal (this will depend on the wal let adapter UI)//For now, just check that clicking doesn't cause errors await page.w a itForTimeout(1000) }) t e st('header login button works', async ({ page }) => { await page.g o to('/')//Check header has login button await e x pect(page.g e tByRole('button', { n, a, m, e: 'Login' })).t oB eVisible()//Click it await page.g e tByRole('button', { n, a, m, e: 'Login' }).c l ick()//Should open modal await page.w a itForTimeout(1000) }) t e st('status chips show MAINNET when RPC has mainnet', async ({ page }) => {//Mock environment variables or API responses as needed await page.g o to('/')//Navigate to a page that shows s t atus (if accessible without login)//This might need to be adjusted based on your routing await page.w a itForTimeout(2000)//Check for status i n dicators (this will depend on your implementation)//For now, just verify the page loads without errors e x pect(page.u r l()).t oC ontain('localhost') }) t e st('bundle preview triggers simulateOnly', async ({ page }) => {//This test would need wal let connection mocked//For now, just test that the bundle page loads await page.g o to('/bundle')//Should show login gate since no wal let connected await e x pect(page.g e tByText('Login Required')).t oB eVisible() }) t e st('settings page loads', async ({ page }) => { await page.g o to('/settings')//Should show login gate await e x pect(page.g e tByText('Login Required')).t oB eVisible() }) t e st('guide page loads', async ({ page }) => { await page.g o to('/guide')//Should show login gate await e x pect(page.g e tByText('Login Required')).t oB eVisible() }) t e st('api endpoints respond correctly', async ({ page }) => {//Test tip floor endpoint const response = await page.request.get('/api/jito/tipfloor')//Should return either success or a proper error e x pect(response.s t atus()).t oB eLessThan(600)//Not a server crash const body = await response.json() e x pect(body).t oB eDefined() }) t e st('nonce endpoint works', async ({ page }) => { const response = await page.request.get('/api/auth/nonce') e x pect(response.s t atus()).t oB e(200) const body = await response.json() e x pect(body.nonce).t oB eDefined() e x pect(typeof body.nonce).t oB e('string') e x pect(body.nonce.length).t oB eGreaterThan(0) }) t e st('bundle submit requires proper format', async ({ page }) => { const response = await page.request.p o st('/api/bundles/submit', { d, a, ta: { t, x, s_, b64: [],//Invalid-empty array }
}) e x pect(response.s t atus()).t oB e(400) const body = await response.json() e x pect(body.error).t oC ontain('Invalid txs_b64') }) })
