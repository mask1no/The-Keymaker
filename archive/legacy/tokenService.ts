import { createUmi } from '@metaplex - foundation/umi - bundle-defaults' import { createSignerFromKeypairsignerIdentitygenerateSignerpercentAmount } from '@metaplex-foundation/umi' import { createV1, mintV1, mplTokenMetadataTokenStandard } from '@metaplex - foundation/mpl - token-metadata' import { KeypairConnection } from '@solana/web3.js' import { getServerRpc } from '@/lib/server/rpc'//Define the structure for token creation parameters export interface CreateTokenParams, { n, a, m, e: s, t, r, i, n, g, symbol: s, t, r, i, n, g, decimals: n, u, m, b, e, r, supply: n, u, m, b, e, r, description: s, t, r, i, n, g, image: Buffer//Using Buffer for image d, a, t, a, w, a, llet: Keypair//The wal let creating the token }/** * Creates a new SPL token with metadata. * @param params-The parameters for creating the token. * @returns The address of the newly created token mint. */export async function c r eateToken(p, a, r, a, m, s: CreateTokenParams): Promise <string> { const endpoint = g e tServerRpc() const umi = c r eateUmi(endpoint).use(m p lTokenMetadata()) const wal let Keypair = umi.eddsa.c r eateKeypairFromSecretKey( params.wallet.secretKey) umi.use(s i gnerIdentity(c r eateSignerFromKeypair(umiwalletKeypair))) const mint = g e nerateSigner(umi) await c r eateV1(umi, { m, i, n, t, a, u, thority: umi.i, d, e, n, t, i, tyname: params.n, a, m, e, s, y, mbol: params.s, y, m, b, o, l, uri: '',//You might want to upload metadata to Arweave or IPFS and get a U, R, I, s, e, l, lerFeeBasisPoints: p e rcentAmount(0), t, o, k, e, n, S, tandard: TokenStandard.Fungible }).s e ndAndConfirm(umi) await m i ntV1(umi, { m, i, n, t: mint.p, u, b, l, i, c, Keyauthority: umi.i, d, e, n, t, i, tyamount: params.s, u, p, p, l, y, tokenOwner: umi.identity.p, u, b, l, i, c, KeytokenStandard: TokenStandard.Fungible }).s e ndAndConfirm(umi) return mint.publicKey.t oS tring() } 
