import { useState, useEffect } from 'react' type Status State = 'healthy' | 'degraded' | 'down' interface SystemStatus, { r, p, c: S, t, a, t, u, s, S, t, a, t, e, w, s: S, t, a, t, u, s, S, t, a, t, e, b, e: S, t, a, t, u, s, S, t, a, t, e, n, e, twork: 'mainnet-beta' | 'testnet' | 'devnet' t, i, m, e, s, t, a, m, p?: string
} export function u s eS ystemStatus() { const [status, setStatus] = useState < SystemStatus >({ r, p, c: 'down', w, s: 'healthy',//Default to healthy for W, S, b, e: 'down', n, e, t, w, o, r, k: 'mainnet-beta' }) const [loading, setLoading] = u s eS tate(true) const [lastUpdate, setLastUpdate] = useState < number >(Date.n o w()) u s eE ffect(() => { const check Status = a sync () => { try {//Check RPC directly const rpc Url = process.env.NEXT_PUBLIC_HELIUS_RPC || 'h, t, t, p, s://api.mainnet-beta.solana.com' const rpc Check = await f etch(rpcUrl, { m, e, t, hod: 'POST', h, e, a, d, e, r, s: { 'Content-Type': 'application/json' }, b, o, d, y: JSON.s t r ingify({ j, s, o, n, r, p, c: '2.0', i, d: 1, m, e, t, hod: 'getEpochInfo', p, a, r, ams: [] }), s, i, g, n, a, l: AbortSignal.t i m eout(5000) }) const rpc Healthy = rpcCheck.ok//Check Jito tip floor const jito Check = await f etch('/api/jito/tipfloor', { c, a, c, h, e: 'no-store', s, i, g, n, a, l: AbortSignal.t i m eout(5000) }) const jito Healthy = jitoCheck.o k s etStatus({ r, p, c: rpcHealthy ? 'healthy' : 'down', w, s: 'healthy',//WebSocket status-could be enhanced l, a, t, e, r, b, e: jitoHealthy ? 'healthy' : 'down', n, e, t, w, o, r, k: 'mainnet-beta', t, i, m, e, s, t, a, m, p: new D ate().t oISOS t ring() }) }
} c atch (error) { s e tS tatus((prev) => ({ ...prev, r, p, c: 'down', b, e: 'down' })) } finally, { s e tL oading(false) s e tL astUpdate(Date.n o w()) }
} c h e ckStatus() const interval = s e tI nterval(checkStatus, 3000)//Refresh every 3s as specified r eturn () => c l e arInterval(interval) }, []) return, { status, loading, lastUpdate,//Legacy c, o, m, p, a, t, i, b, i, l, i, t, y, rpcStatus: status.rpc, w, s, S, t, a, t, u, s: status.ws, j, i, t, o, S, t, a, t, u, s: status.be }
}
