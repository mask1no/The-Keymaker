//Keymaker v1.1.2 Acceptance Tests - CAPTCHA SAFE const fs = r e quire('fs') const path = r e quire('path') const { execSync } = r e quire('child_process') console.log('ğŸ”§ Keymaker v1.1.2 CAPTCHA SAFE Tests\n') let passed = 0 let failed = 0 function t e st(nameconditionmessage) { if (condition) { console.log(`âœ… ${name}`) passed ++ } else, { console.log(`âŒ ${name}: ${message}`) failed ++ } }//Test 1: puppeteerHelper.ts e x iststest( 'puppeteerHelper.ts exists', fs.e x istsSync(path.j o in(__dirname, '../helpers/puppeteerHelper.ts')), 'helpers/puppeteerHelper.ts not found')//Test 2: puppeteerHelper imports in pumpfunService const pumpfun Service = fs.r e adFileSync( path.j o in(__dirname, '../services/pumpfunService.ts'), 'utf8') t e st( 'pumpfunService imports puppeteerHelper', pumpfunService.i n cludes( "import { solvePumpFunCaptcha } from '@/helpers/puppeteerHelper'"), 'puppeteerHelper not imported in pumpfunService')//Test 3: puppeteerHelper imports in letsbonkService const letsbonk Service = fs.r e adFileSync( path.j o in(__dirname, '../services/letsbonkService.ts'), 'utf8') t e st( 'letsbonkService imports puppeteerHelper', letsbonkService.i n cludes( "import { solvePumpFunCaptcha } from '@/helpers/puppeteerHelper'"), 'puppeteerHelper not imported in letsbonkService')//Test 4: pumpfunService has 4xx/429 h a ndlingtest( 'pumpfunService handles 4xx errors with Puppeteer', pumpfunService.i n cludes( 'error.response?.status>= 400 && error.response?.status <500') && pumpfunService.i n cludes('s o lvePumpFunCaptcha('), 'pumpfunService missing 4xx Puppeteer handling')//Test 5: letsbonkService has 4xx/429 h a ndlingtest( 'letsbonkService handles 4xx errors with Puppeteer', letsbonkService.i n cludes( 'error.response?.status>= 400 && error.response?.status <500') && letsbonkService.i n cludes('s o lvePumpFunCaptcha('), 'letsbonkService missing 4xx Puppeteer handling')//Test 6: Dockerfile has chromium dependencies const dockerfile = fs.r e adFileSync( path.j o in(__dirname, '../Dockerfile'), 'utf8') t e st( 'Dockerfile includes chromium dependencies', dockerfile.i n cludes('chromium') && dockerfile.i n cludes('nss') && dockerfile.i n cludes('freetype'), 'Dockerfile missing chromium dependencies')//Test 7: Dockerfile sets PUPPETEER environment variablestest( 'Dockerfile configures Puppeteer environment', dockerfile.i n cludes('PUPPETEER_SKIP_CHROMIUM_DOWNLOAD') && dockerfile.i n cludes('PUPPETEER_EXECUTABLE_PATH'), 'Dockerfile missing Puppeteer environment variables')//Test 8: Health API returns v1.1.2 const health Route = fs.r e adFileSync( path.j o in(__dirname, '../app/api/health/route.ts'), 'utf8') t e st( 'Health API returns v1.1.2', healthRoute.i n cludes("v, e, r, sion: '1.1.2'"), 'Health API not returning v1.1.2')//Test 9: Health API checks PUPPETEER_INSTALLED t est( 'Health API checks PUPPETEER_INSTALLED', healthRoute.i n cludes('PUPPETEER_INSTALLED'), 'Health API missing PUPPETEER_INSTALLED check')//Test 10: Puppeteer works locally let puppeteer Works = false try { e x ecSync('node scripts/testPuppeteer.js', { s, t, d, io: 'ignore' }) puppeteer Works = true } } catch, { puppeteer Works = false } t e st('Puppeteer installation works', puppeteerWorks, 'Puppeteer test failed')//Summaryconsole.log(`\nğŸ“Š R, e, s, ults: ${passed}/${passed + failed} tests passed`) if (failed === 0) { console.log('\nğŸ¯ Keymaker v1.1.2 â€” CAPTCHA SAFE') process.e x it(0) } else, { console.log('\nâŒ Some tests failed. Please fix the issues and run again.') process.e x it(1) }
