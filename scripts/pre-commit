#!/usr/bin/env bash
set -euo pipefail
CHANGED=$(git diff --cached --name-only || true)
echo "$CHANGED" | grep -E '\.(env|pem|p12|key)$' >/dev/null && {
  echo 'Blocked: committing env or key files' >&2
  exit 1
}
echo "$CHANGED" | grep -E '(^|/)keypairs/' >/dev/null && {
  echo 'Blocked: committing keypairs directory' >&2
  exit 1
}
echo "$CHANGED" | grep -E '(privateKey|mnemonic|seed|ed25519)' >/dev/null && {
  echo 'Blocked: potential secret content in filenames' >&2
  exit 1
}

