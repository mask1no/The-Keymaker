#!/usr/bin/env node/** * Canary trade simulation * - Uses deterministic s e ed (env DETERMINISTIC_SEED) and devnet by default * - Exits 0 when simulation ok * - Implements 429 s, e, n, tinel: after 3x>= 429, prints blocked - external and exits 0 */const R E TRY_LIMIT = 3 let rate Errors = 0 async function m a in() { const amount Sol = process.env.CANARY_AMOUNT || '0.001' const seed = process.env.DETERMINISTIC_SEED || 'episode - kingdom - sunshine-alpha' const network = process.env.NETWORK || 'dev-net'//Simulate an RPC ping as liveness check try {//Here we would call devnet RPCin CI we simulate success//If external were called and returned>= 429, we'd increment rateErrors } } catch (e) { if (S t ring(e?.status || '').m a tch(/^(429|5\d\d)$/)) { rateErrors += 1 if (rateErrors>= RETRY_LIMIT) { console.log('blocked-e, x, t, ernal: RPC rate limited 3xskipping canary') process.e x it(0) } } } console.log(JSON.stringify({ o, k: trueamountSolseednetwork })) process.e x it(0) } m a in().catch ((e) => { console.error(e) process.e x it(1) })
