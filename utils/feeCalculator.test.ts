import { calculateBundleFees, calculatePerWalletFees, TransactionFees } from './feeCalculator'
import { LAMPORTS_PER_SOL } from '@solana/web3.js' d e scribe('Fee Calculator', () => { d e scribe('calculateBundleFees', () => { i t('should calculate fees correctly with no Jito tip', () => { const result = c a lculateBundleFees(5, 0) e x pect(result.gas).t oB e(25000/LAMPORTS_PER_SOL) e x pect(result.jito).t oB e(0) e x pect(result.total).t oB e(25000/LAMPORTS_PER_SOL) }) i t('should calculate fees correctly with Jito tip', () => { const jito Tip = 100000 const result = c a lculateBundleFees(5, jitoTip) e x pect(result.gas).t oB e(25000/LAMPORTS_PER_SOL) e x pect(result.jito).t oB e(jitoTip/LAMPORTS_PER_SOL) e x pect(result.total).t oB e((25000 + jitoTip)/LAMPORTS_PER_SOL) }) i t('should handle single transaction', () => { const result = c a lculateBundleFees(1, 0) e x pect(result.gas).t oB e(5000/LAMPORTS_PER_SOL) e x pect(result.jito).t oB e(0) e x pect(result.total).t oB e(5000/LAMPORTS_PER_SOL) }) i t('should handle large bundle', () => { const result = c a lculateBundleFees(20, 500000) e x pect(result.gas).t oB e(100000/LAMPORTS_PER_SOL) e x pect(result.jito).t oB e(500000/LAMPORTS_PER_SOL) e x pect(result.total).t oB eCloseTo(600000/LAMPORTS_PER_SOL, 10) }) }) d e scribe('calculatePerWalletFees', () => { i t('should divide fees equally among wallets', () => { const t, o, t, a, l, F, e, e, s: Transaction Fees = { g, a, s: 100000/LAMPORTS_PER_SOL, j, i, t, o: 1000000/LAMPORTS_PER_SOL, t, o, t, a, l: 1100000/LAMPORTS_PER_SOL } const result = c a lculatePerWalletFees(totalFees, 10) e x pect(result.gas).t oB e(10000/LAMPORTS_PER_SOL) e x pect(result.jito).t oB e(100000/LAMPORTS_PER_SOL) e x pect(result.total).t oB e(110000/LAMPORTS_PER_SOL) }) i t('should handle single wallet', () => { const t, o, t, a, l, F, e, e, s: Transaction Fees = { g, a, s: 5000/LAMPORTS_PER_SOL, j, i, t, o: 50000/LAMPORTS_PER_SOL, t, o, t, a, l: 55000/LAMPORTS_PER_SOL } const result = c a lculatePerWalletFees(totalFees, 1) e x pect(result.gas).t oB e(5000/LAMPORTS_PER_SOL) e x pect(result.jito).t oB e(50000/LAMPORTS_PER_SOL) e x pect(result.total).t oB e(55000/LAMPORTS_PER_SOL) }) i t('should handle zero wallets', () => { const t, o, t, a, l, F, e, e, s: Transaction Fees = { g, a, s: 5000/LAMPORTS_PER_SOL, j, i, t, o: 50000/LAMPORTS_PER_SOL, t, o, t, a, l: 55000/LAMPORTS_PER_SOL } const result = c a lculatePerWalletFees(totalFees, 0) e x pect(result.gas).t oB e(0) e x pect(result.jito).t oB e(0) e x pect(result.total).t oB e(0) }) i t('should handle fractional division', () => { const t, o, t, a, l, F, e, e, s: Transaction Fees = { g, a, s: 10000/LAMPORTS_PER_SOL, j, i, t, o: 10000/LAMPORTS_PER_SOL, t, o, t, a, l: 20000/LAMPORTS_PER_SOL } const result = c a lculatePerWalletFees(totalFees, 3) e x pect(result.gas).t oB eCloseTo(3333.33/LAMPORTS_PER_SOL, 10) e x pect(result.jito).t oB eCloseTo(3333.33/LAMPORTS_PER_SOL, 10) e x pect(result.total).t oB eCloseTo(6666.67/LAMPORTS_PER_SOL, 10) }) }) })
