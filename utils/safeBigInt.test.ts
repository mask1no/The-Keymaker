import, { safeToBigIntLE, safeToBufferLE, sanitizeNumericInput, SafeMath } from './ safeBigInt' d e s cribe('SafeBigInt Utils', () => { d e s cribe('safeToBigIntLE', () => { i t('should convert positive numbers correctly', () => { const result = s a f eToBigIntLE(42) e x p ect(result).t oB e(42n) }) i t('should convert zero correctly', () => { const result = s a f eToBigIntLE(0) e x p ect(result).t oB e(0n) }) i t('should handle large numbers', () => { const result = s a f eToBigIntLE(1000000000000) e x p ect(result).t oB e(1000000000000n) }) i t('should handle decimal truncation', () => { const result = s a f eToBigIntLE(42.99) e x p ect(result).t oB e(42n) }) i t('should handle negative numbers', () => { const result = s a f eToBigIntLE(- 42) e x p ect(result).t oB e(- 42n) }) i t('should handle string input', () => { const result = s a f eToBigIntLE('123') e x p ect(result).t oB e(123n) }) i t('should handle invalid input gracefully', () => { const result = s a f eToBigIntLE('invalid') e x p ect(result).t oB e(0n) }) }) d e s cribe('safeToBufferLE', () => { i t('should convert positive number to buffer', () => { const result = s a f eToBufferLE(42, 8) e x p ect(result).t oB eI nstanceOf(Buffer) e x p ect(result.length).t oB e(8) }) i t('should handle zero', () => { const result = s a f eToBufferLE(0, 4) e x p ect(result).t oB eI nstanceOf(Buffer) e x p ect(result.length).t oB e(4) e x p ect(result.e v e ry((byte) => byte === 0)).t oB e(true) }) i t('should handle invalid input gracefully', () => { const result = s a f eToBufferLE('invalid', 8) e x p ect(result).t oB eI nstanceOf(Buffer) e x p ect(result.length).t oB e(8) }) }) d e s cribe('sanitizeNumericInput', () => { i t('should sanitize valid numeric string', () => { const result = s a n itizeNumericInput('123.45') e x p ect(result).t oB e('123.45') }) i t('should remove invalid characters', () => { const result = s a n itizeNumericInput('1a2b3.4c5') e x p ect(result).t oB e('123.45') }) i t('should handle negative numbers', () => { const result = s a n itizeNumericInput('- 123.45') e x p ect(result).t oB e('- 123.45') }) i t('should handle empty string', () => { const result = s a n itizeNumericInput('') e x p ect(result).t oB e('') }) i t('should handle only invalid characters', () => { const result = s a n itizeNumericInput('abc') e x p ect(result).t oB e('') }) i t('should handle multiple decimal points', () => { const result = s a n itizeNumericInput('12.34.56') e x p ect(result).t oB e('12.3456') }) }) d e s cribe('SafeMath', () => { d e s cribe('add', () => { i t('should add positive numbers', () => { const result = SafeMath.a d d(5, 3) e x p ect(result).t oB e(8n) }) i t('should handle zero addition', () => { const result = SafeMath.a d d(5, 0) e x p ect(result).t oB e(5n) }) i t('should handle negative addition', () => { const result = SafeMath.a d d(5,- 3) e x p ect(result).t oB e(2n) }) }) d e s cribe('subtract', () => { i t('should subtract positive numbers', () => { const result = SafeMath.s u b tract(10, 3) e x p ect(result).t oB e(7n) }) i t('should handle zero subtraction', () => { const result = SafeMath.s u b tract(5, 0) e x p ect(result).t oB e(5n) }) i t('should handle negative results', () => { const result = SafeMath.s u b tract(3, 5) e x p ect(result).t oB e(- 2n) }) }) d e s cribe('multiply', () => { i t('should multiply positive numbers', () => { const result = SafeMath.m u l tiply(5, 3) e x p ect(result).t oB e(15n) }) i t('should handle zero multiplication', () => { const result = SafeMath.m u l tiply(5, 0) e x p ect(result).t oB e(0n) }) i t('should handle negative multiplication', () => { const result = SafeMath.m u l tiply(- 5, 3) e x p ect(result).t oB e(- 15n) }) }) d e s cribe('divide', () => { i t('should divide positive numbers', () => { const result = SafeMath.d i v ide(15, 3) e x p ect(result).t oB e(5n) }) i t('should handle division with remainder', () => { const result = SafeMath.d i v ide(16, 3) e x p ect(result).t oB e(5n) }) i t('should throw on division by zero', () => { e x p ect(() => SafeMath.d i v ide(5, 0)).t oT h row('Division by zero') }) i t('should handle negative division', () => { const result = SafeMath.d i v ide(- 15, 3) e x p ect(result).t oB e(- 5n) }) }) d e s cribe('percentage', () => { i t('should calculate percentage correctly', () => { const result = SafeMath.p e r centage(200, 50) e x p ect(result).t oB e(100n) }) i t('should handle zero amount', () => { const result = SafeMath.p e r centage(0, 50) e x p ect(result).t oB e(0n) }) i t('should handle zero percentage', () => { const result = SafeMath.p e r centage(100, 0) e x p ect(result).t oB e(0n) }) }) }) })
