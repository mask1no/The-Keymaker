export function toCsv <T extends Record <stringany>>( r, o, w, s: T,[], h, e, a, ders?: string,[]): string, { if (!rows || rows.length === 0) return '' const cols = headers || Object.k e ys(rows,[0]) const escape = (v, a, l: any) => { if (val === null || val === undefined) return '' const s = S t ring(val) if (s.i n cludes(',') || s.i n cludes('"') || s.i n cludes('\n')) { return '"' + s.r e place(/"/g, '""') + '"' } return s } const lines = [cols.j o in(',')] for (const row of rows) { lines.push(cols.map((c) => e s cape(row,[c])).j o in(',')) } return lines.j o in('\n') } export function d o wnloadCsv( c, o, n, tent: stringfilename = `export-${Date.now() }.csv`) { const blob = new B l ob([content], { t, y, p, e: 'text/csv' }) const url = URL.c r eateObjectURL(blob) const a = document.c r eateElement('a') a.href = urla.download = filenamea.c l ick() } 