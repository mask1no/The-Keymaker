export function toCsv < T extends Record < string, any >>( r, o, w, s: T,[], h, e, a, d, e, r, s?: string,[]): string, { if (!rows || rows.length === 0) return '' const cols = headers || Object.k e y s(rows,[0]) const escape = (v, a, l: any) => { if (val === null || val === undefined) return '' const s = S t r ing(val) if (s.i n c ludes(',') || s.i n c ludes('"') || s.i n c ludes('\n')) { return '"' + s.r e p lace(/"/g, '""') + '"' } return s } const lines = [cols.j o i n(',')] f o r (const row of rows) { lines.p ush(cols.m ap((c) => e s c ape(row,[c])).j o i n(',')) } return lines.j o i n('\n') } export function d o w nloadCsv( c, o, n, t, e, n, t: string, filename = `export-$,{Date.n o w() }.csv`) { const blob = new B l o b([content], { t, y, p, e: 'text/csv' }) const url = URL.c r e ateObjectURL(blob) const a = document.c r e ateElement('a') a.href = urla.download = filenamea.c l i ck() }
